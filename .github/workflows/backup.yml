name: Auto XMind Backup

# è§¦å‘æ¡ä»¶
on:
  schedule:
    # æ¯å¤©åŒ—äº¬æ—¶é—´å‡Œæ™¨ 4 ç‚¹è¿è¡Œ (UTC æ—¶é—´ 20:00)
    # åˆ† æ—¶ æ—¥ æœˆ å‘¨
    - cron: '0 20 * * *'
  # å…è®¸ä½ æ‰‹åŠ¨ç‚¹å‡»æŒ‰é’®è§¦å‘ (æ–¹ä¾¿æµ‹è¯•)
  workflow_dispatch:

jobs:
  backup_job:
    runs-on: ubuntu-latest  # ä½¿ç”¨æœ€æ–°çš„ Ubuntu è™šæ‹Ÿæœº

    steps:
      # 1. æ‹‰å–ä½ çš„ä»£ç ä»“åº“
      - name: Checkout code
        uses: actions/checkout@v3

      # 2. å®‰è£… Python ç¯å¢ƒ
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      # 3. å®‰è£…ä¾èµ–åº“
      - name: Install dependencies
        run: |
          pip install requests PyGithub

      # 4. è¿è¡Œå¤‡ä»½è„šæœ¬ (æ³¨å…¥ç¯å¢ƒå˜é‡)
      - name: Run backup script
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}
          XMIND_COOKIE: ${{ secrets.XMIND_COOKIE }}
          XMIND_FWT: ${{ secrets.XMIND_FWT }} # ğŸ‘‡ æ–°åŠ è¿™ä¸€è¡Œ
        run: python sync_xmind.py
